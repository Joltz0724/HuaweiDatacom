# 交换机的工作机制
交换机开机后，在内存中构建一张空白的 MAC 地址表。在收到数据帧时，交换机会学习数据帧的 SMAC 地址，将它和接收帧的接口绑定到 MAC 地址表中。

**交换机的泛洪**

- 收到广播帧：直接泛洪
- 收到组播帧：缺省情况直接泛洪
- 收到 DMAC 未知的单播帧：直接泛洪

**交换机的转发**

收到 DMAC 已知的单播帧：根据 MAC 地址表项进行转发

**交换机的丢弃**

如果收到数据帧的接口是发送该数据帧的接口，则直接丢弃。

# MAC 地址表
**MAC 地址表的老化**

MAC 地址表的老化时间缺省 300s，交换机每次接收到数据帧，都会学习 SMAC 地址，若 SMAC 在地址表中存在，则会刷新老化时间，反之新增一条 MAC 地址表项。

**MAC 地址表立即删除的场景**

- 拔掉网线，线路故障
- 人为 shutdown
- 端口对端设备失效/关机

**MAC 地址表漂移/震荡**

当交换机在一个广播域的不同接口学习到相同的 MAC 地址，新学到的会替换掉旧的 MAC 地址表项。

在二层网络中，若出现环路，MAC 地址表不断的震荡，交换机在不同接口不断学习新的 MAC 地址表项，则会导致网络的波动。

**交换机如何区分 Ethernet Ⅱ 和 IEEE 802.3**

从 Type/Length 字段值可以区分两种帧类型：

- 当 Type 字段值小于等于 1500（0x05DC）时，帧使用的是 IEEE 802.3 格式。
- 当 Type 字段值大于等于 1536（0x0600）时，帧使用的是 Ethernet II 格式。

Ethernet Ⅱ 和 IEEE 802.3 的使用场景：
- 一般用户应用程序产生数据是通过 Ethernet Ⅱ 格式封装，比如 ftp、http、telnet
- 一般用于网络运行的协议类数据是通过 IEEE 802.3 格式封装，比如 ISIS、CDP、PVST、VTP、STP
